{"level":"error","message":"[processSingleDocument] Errore: Unexpected token 'I', \"I apologiz\"... is not valid JSON","stack":"SyntaxError: Unexpected token 'I', \"I apologiz\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at extractDataWithClaudeFromBuffer (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:37:21)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async processSingleDocument (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/aiController.js:24:24)","timestamp":"2025-08-13T17:10:50.678Z"}
{"level":"error","message":"[queryClaude] Errore durante la chiamata a Claude: Unexpected token 'E', \"Ecco i dat\"... is not valid JSON","stack":"SyntaxError: Unexpected token 'E', \"Ecco i dat\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at queryClaude (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:80:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async extractDataWithClaudeFromBuffer (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:119:16)\n    at async processSingleDocument (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/aiController.js:24:24)","timestamp":"2025-08-13T18:00:43.393Z"}
{"level":"error","message":"[extractDataWithClaudeFromBuffer] Errore durante estrazione dati: Unexpected token 'E', \"Ecco i dat\"... is not valid JSON","stack":"SyntaxError: Unexpected token 'E', \"Ecco i dat\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at queryClaude (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:80:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async extractDataWithClaudeFromBuffer (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:119:16)\n    at async processSingleDocument (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/aiController.js:24:24)","timestamp":"2025-08-13T18:00:43.394Z"}
{"level":"error","message":"[processSingleDocument] Errore: Unexpected token 'E', \"Ecco i dat\"... is not valid JSON","stack":"SyntaxError: Unexpected token 'E', \"Ecco i dat\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at queryClaude (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:80:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async extractDataWithClaudeFromBuffer (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/services/claudeService.js:119:16)\n    at async processSingleDocument (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/aiController.js:24:24)","timestamp":"2025-08-13T18:00:43.394Z"}
{"level":"error","message":"[processSingleDocument] Errore: Nessun file caricato","stack":"Error: Nessun file caricato\n    at processSingleDocument (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/aiController.js:11:19)\n    at Layer.handle [as handle_request] (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/route.js:149:13)\n    at multerMiddleware (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/multer/lib/make-middleware.js:19:41)\n    at Layer.handle [as handle_request] (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/index.js:284:15\n    at router.process_params (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/index.js:346:12)","timestamp":"2025-08-14T16:17:09.281Z"}
{"level":"error","message":"[generateContracts] Errore: Cannot convert undefined or null to object","stack":"TypeError: Cannot convert undefined or null to object\n    at Object.entries (<anonymous>)\n    at file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:56:36\n    at Array.forEach (<anonymous>)\n    at generatePdf (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:55:11)\n    at async generateContracts (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:26:26)","timestamp":"2025-08-19T19:17:46.065Z"}
{"level":"error","message":"[generateContracts] Errore: Could not find page for PDFRef 6656 0 R","stack":"Error: Could not find page for PDFRef 6656 0 R\n    at PDFForm.findWidgetPage (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/pdf-lib/cjs/api/form/PDFForm.js:601:23)\n    at PDFForm.flatten (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/pdf-lib/cjs/api/form/PDFForm.js:458:33)\n    at generatePdf (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:78:10)\n    at async generateContracts (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:26:26)","timestamp":"2025-08-19T19:21:32.965Z"}
{"level":"error","message":"[generateContracts] Errore: Could not find page for PDFRef 6656 0 R","stack":"Error: Could not find page for PDFRef 6656 0 R\n    at PDFForm.findWidgetPage (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/pdf-lib/cjs/api/form/PDFForm.js:601:23)\n    at PDFForm.flatten (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/pdf-lib/cjs/api/form/PDFForm.js:458:33)\n    at generatePdf (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:78:10)\n    at async generateContracts (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:26:26)","timestamp":"2025-08-19T19:24:55.249Z"}
{"level":"error","message":"[generateContracts] Errore: Multi error","stack":"Error: Multi error\n    at new XTTemplateError (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/docxtemplater/js/errors.js:21:16)\n    at throwMultiError (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/docxtemplater/js/errors.js:62:13)\n    at verifyErrors (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/docxtemplater/js/docxtemplater.js:186:5)\n    at Docxtemplater.compile (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/docxtemplater/js/docxtemplater.js:485:7)\n    at new Docxtemplater (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/docxtemplater/js/docxtemplater.js:226:12)\n    at generateDocx (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:51:17)\n    at generateContracts (file:///Users/johnnycannatella/WebstormProjects/sparkdocai/api/controllers/contractController.js:25:39)\n    at Layer.handle [as handle_request] (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/express/lib/router/route.js:149:13)\n    at done (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/multer/lib/make-middleware.js:59:7)\n    at indicateDone (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/multer/lib/make-middleware.js:63:68)\n    at Multipart.<anonymous> (/Users/johnnycannatella/WebstormProjects/sparkdocai/api/node_modules/multer/lib/make-middleware.js:187:7)\n    at Multipart.emit (node:events:507:28)\n    at emitCloseNT (node:internal/streams/destroy:148:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:89:21)","timestamp":"2025-08-19T19:39:33.176Z"}
{"level":"error","message":"[generateContracts] Errore: spawn libreoffice ENOENT","stack":"Error: spawn libreoffice ENOENT\n    at ChildProcess._handle.onexit (node:internal/child_process:286:19)\n    at onErrorNT (node:internal/child_process:484:16)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)","timestamp":"2025-08-19T19:43:32.318Z"}
